/*
* SlickSelect v2.0.1 Copyright (c) 2015 AJ Savino
* https://github.com/koga73/SlickSelect
* MIT LICENSE
*/
var SlickSelect={EVENT_CHANGE:"change",EVENT_OPEN:"open",EVENT_CLOSE:"close",CLASS_SLICKSELECT:"slickselect",CLASS_DISPLAY_SELECTED:"slickselect-display-selected",CLASS_OPTIONS:"slickselect-options",CLASS_OPTION:"slickselect-option",CLASS_OPTION_SELECTED:"slickselect-option-selected",CLASS_OPTION_HIGHLIGHT:"slickselect-option-highlight",CLASS_OPEN:"slickselect-open",CLASS_HIDDEN:"slickselect-hidden",defaultParams:{placeholder:null,scroll:!1,scrollSnapDist:8,clickDist:8}};!function(e){e.fn.SlickSelect=function(t){var l=e.extend({},e.fn.SlickSelect.defaultParams,t),n=this,i={_slickSelect:null,_displaySelected:null,_options:null,_keyIndex:-1,_isDragging:!1,_beginDragPoint:null,_beginDragOptionsPoint:null,isOpen:!1,selectedIndex:-1,value:null},c={initialize:function(){var t=n[0].getAttribute("class");t=t?t+" ":"",t+=SlickSelect.CLASS_SLICKSELECT;var o=document.createElement("div");o.setAttribute("tabindex",0),o.setAttribute("class",t),i._slickSelect=o;var a=document.createElement("span");a.setAttribute("class",SlickSelect.CLASS_DISPLAY_SELECTED),i._displaySelected=a;var s=document.createElement("ul");s.setAttribute("class",SlickSelect.CLASS_OPTIONS),i._options=s;for(var r=n[0].querySelectorAll("option"),S=r.length,_=0;S>_;_++){var d=r[_],u=document.createElement("li");u.setAttribute("class",SlickSelect.CLASS_OPTION),u.innerHTML=d.innerHTML;for(var g=d.attributes,p=g.length,k=0;p>k;k++){var v=g[k];v.specified&&("value"==v.name?u.setAttribute("data-value",d.getAttribute("value")):"class"==v.name||/^(data\-)?ng\-/.test(v.name)||u.setAttribute(v.name,v.value))}s.appendChild(u)}o.appendChild(a),o.appendChild(s),n[0].parentNode.insertBefore(o,n[0]),n.addClass(SlickSelect.CLASS_HIDDEN);var f=n[0].querySelectorAll("option[selected]");c.selectOption(f.length?f[0].getAttribute("value"):-1);var h=e(o),O=e(document);O.on("keydown",c._handler_keydown),h.on("focusout",c._handler_focusout),h.on("click",c._handler_click),l.scroll&&(h.on("touchstart mousedown",c._handler_beginDrag),O.on("touchmove mousemove",c._handler_moveDrag),O.on("touchend mouseup",c._handler_endDrag))},destroy:function(){c.close(),c._handler_endDrag();var t=i._slickSelect;if(t){var l=e(t);l.off("focusout",c._handler_focusout),l.off("click",c._handler_click),l.off("touchstart mousedown",c._handler_beginDrag);var o=e(document);o.off("keydown",c._handler_keydown),o.off("touchmove mousemove",c._handler_moveDrag),o.off("touchend mouseup",c._handler_endDrag),t.parentNode&&t.parentNode.removeChild(t),i._displaySelected=null,i._options=null,i._slickSelect=null}i._beginDragPoint=null,i._beginDragOptionsPoint=null,n.removeClass(SlickSelect.CLASS_HIDDEN)},open:function(){i.isOpen||(i.isOpen=!0,e(i._slickSelect).addClass(SlickSelect.CLASS_OPEN),n.trigger(SlickSelect.EVENT_OPEN))},close:function(){if(i.isOpen){i.isOpen=!1;var t=e(i._slickSelect),l=e("."+SlickSelect.CLASS_OPTION,t);l.removeClass(SlickSelect.CLASS_OPTION_HIGHLIGHT),i._keyIndex=-1,t.removeClass(SlickSelect.CLASS_OPEN),n.trigger(SlickSelect.EVENT_CLOSE)}},selectOption:function(t){var o=e("."+SlickSelect.CLASS_OPTION,e(i._slickSelect));o.removeClass(SlickSelect.CLASS_OPTION_SELECTED);var a=null;if(isNaN(t))a=t.jquery?t:o.filter("[data-value='"+t+"']");else{if(-1==t){var s=n.attr("data-placeholder")||l.placeholder;if(s)return i._displaySelected.innerHTML=s,i.selectedIndex=-1,i.value=null,void(n[0].selectedIndex=i.selectedIndex);t=0}-1!=t&&(a=o.eq(t))}var r=a.index(),S=o.eq(r);S.addClass(SlickSelect.CLASS_OPTION_SELECTED),l.scroll&&(i._options.style.top=-S.position().top-1+"px"),i.selectedIndex!=r&&(i._displaySelected.innerHTML=S[0].innerHTML,i.selectedIndex=r,i.value=a.attr("data-value"),n[0].selectedIndex=i.selectedIndex,n.trigger(SlickSelect.EVENT_CHANGE)),c.close()},_handler_click:function(t){t.preventDefault();var n=!l.scroll;if(!n){var o=c._getTouchPoint(t),a=Math.abs(o[1]-i._beginDragPoint[1]);a<l.clickDist&&(n=!0)}if(n){var s=e(t.target);s.hasClass(SlickSelect.CLASS_OPTION)?c.selectOption(s):i.isOpen?c.close():c.open()}return!1},_handler_keydown:function(t){var l=e(i._slickSelect);if(l.is(":focus")){var n=e("."+SlickSelect.CLASS_OPTION,l),o=n.length,a=!1,s=t.keyCode;switch(!0){case 38==s:i._keyIndex--,i._keyIndex<0&&(i._keyIndex=o-1),a=!0,i.isOpen||c.open();break;case 40==s:i._keyIndex++,i._keyIndex>o-1&&(i._keyIndex=0),a=!0,i.isOpen||c.open();break;case 13==s:case 32==s:i.isOpen?-1!=i._keyIndex?c.selectOption(i._keyIndex):c.close():c.open();break;case s>=48&&57>=s:case s>=65&&90>=s:case s>=97&&122>=s:var r=(i._keyIndex,n.slice(i._keyIndex+1,o));r=e.merge(r,n.slice(0,i._keyIndex+1));for(var S=r.length,_=0;S>_;_++){var d=e(r[_]);if(d.text().substr(0,1).toLowerCase()==String.fromCharCode(s).toLowerCase()){i._keyIndex=(_+i._keyIndex+1)%S,a=!0,i.isOpen||c.open();break}}break;default:return}if(t.preventDefault(),a){n.removeClass(SlickSelect.CLASS_OPTION_HIGHLIGHT);var u=n.eq(i._keyIndex);u.addClass(SlickSelect.CLASS_OPTION_HIGHLIGHT);var g=e(i._options),p=g[0].scrollHeight,k=g.height();if(p>k){var v=g.scrollTop(),f=u.position().top+v,h=u.outerHeight();f+h>v+k?g.scrollTop(f-k+h):v>f&&g.scrollTop(f)}}return!1}},_handler_focusout:function(e){return e.preventDefault(),i.isOpen&&c.close(),!1},_handler_beginDrag:function(t){if(!i._isDragging){i._beginDragPoint=c._getTouchPoint(t);var l=e(i._options);if(l.is(":visible")){i._isDragging=!0;var n=l.position();i._beginDragOptionsPoint=[n.left,n.top]}}},_handler_moveDrag:function(t){if(i._isDragging){var n=e(i._slickSelect),o=e(i._options),a=c._getTouchPoint(t),s=i._beginDragOptionsPoint[1]+(a[1]-i._beginDragPoint[1]),r=n.outerHeight()-o.outerHeight()-1,S=-1;s=Math.max(Math.min(s,S),r);for(var _=.5*n.outerHeight(),d=e("."+SlickSelect.CLASS_OPTION,n),u=d.length,g=0;u>g;g++){var p=e(d[g]),k=p.position().top,v=k+.5*p.outerHeight(),f=Math.abs(s+v-_);_>=f&&(d.removeClass(SlickSelect.CLASS_OPTION_SELECTED),d.eq(g).addClass(SlickSelect.CLASS_OPTION_SELECTED),f<l.scrollSnapDist&&(s=-k+S))}o.css("top",s+"px")}},_handler_endDrag:function(){if(i._isDragging){i._isDragging=!1;var t=e("."+SlickSelect.CLASS_OPTION_SELECTED,e(i._slickSelect));t.length&&c.selectOption(t)}},_getTouchPoint:function(e){var t=e;return e.originalEvent&&(e.originalEvent.touches||e.originalEvent.changedTouches)&&(t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]),[t.clientX,t.clientY]}};return n.SlickSelect={isOpen:function(){return i.isOpen},selectedIndex:function(){return i.selectedIndex},value:function(){return i.value},initialize:c.initialize,destroy:c.destroy,open:c.open,close:c.close,selectOption:c.selectOption},n.SlickSelect.initialize(),n},e.fn.SlickSelect.defaultParams=SlickSelect.defaultParams}(jQuery);